Overview

The generate_valid_rcode_list.py script automates the process of discovering, extracting, and maintaining a list of valid “R-codes” (or disorders) from a PanelApp database. These valid R-codes are stored in an output file for use by other systems (e.g., a web application) to verify whether a submitted R-code is valid.

By default, this script:
-	Locates a PanelApp database within the project directory.

-	Sets up comprehensive logging (to both a log file and the console).
  
-	Checks if there is a newly updated PanelApp .db file.
  
-	Extracts unique relevant disorders (R-codes) from this database.
  
-	Appends new (not-yet-seen) R-codes to an output file.
  
-	Repeats the process continuously in a loop, waiting 120 seconds between each run (for testing purposes).

Project Structure

A typical directory layout could look like this:
	
	Y2_Genepanel_project/
	├─ logs/
	│   └─ generate_valid_rcode_list.log
	├─ generate_valid_rcodes_output/
	│   └─ unique_relevant_disorders.txt
	└─ PanelGeneMapper/
	    └─ generate_valid_rcode_list.py

-	logs/: Contains log files generated by this script (by default, generate_valid_rcode_list.log).
  
-	generate_valid_rcodes_output/: Stores the output file of valid R-codes (unique_relevant_disorders.txt).
  
-	PanelGeneMapper/: A folder where generate_valid_rcode_list.py might reside.

Note: The actual structure can vary; what matters is that you keep track of where the root directory is and where the PanelApp .db file is stored.

Important Considerations

1. Locating the Root Directory

By default, the script determines the root directory like this:

	root_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))

This means:
	-	The root directory is the parent folder of the folder where generate_valid_rcode_list.py resides.
	-	If you move generate_valid_rcode_list.py to another location, or your project structure changes, you will need to update this line accordingly to ensure the script can correctly find its root directory.

2. Scheduled Execution and Sleep Interval

Inside the script, there is an infinite loop with a time.sleep(120) call, which waits 120 seconds (2 minutes) between each iteration of the script:

	while True:
   		main()
    		time.sleep(120)  # Wait for 2 minutes

This interval is primarily for testing or demonstration purposes (so you can see changes happen relatively quickly). In a real production scenario, you might want to run this less frequently—for example, once a month—to update the valid R-codes list. You can do this by:
	1.	Adjusting the time.sleep value (e.g., change to time.sleep(2592000) for 30 days).
	2.	Or disabling the infinite loop and scheduling the script via cron, systemd timers, or a CI/CD pipeline to run monthly.
 

By running this script regularly (e.g., monthly), you ensure your valid R-codes list always stays up-to-date with the latest medical or genetic information from PanelApp.

Logging
	-	File Logs: Everything from INFO level and above gets written to logs/generate_valid_rcode_list.log.
	-	Console Logs: Warnings (WARNING level) and above are shown on the console.
	-	You can tailor these levels in the setup_logging function.
